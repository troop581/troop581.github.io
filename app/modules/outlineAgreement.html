<div ng-controller="outlineAgreement as vm">
    <div class="container">
        <form class="form-inline" ng-hide="vm.data.editContract">
            <div class="form-group">
                <div class="col-lg-12">
                    <div class="input-group">
                        <input type="text" maxlength="10" class="form-control input-sm" placeholder="Goto OA#" ng-keyup="$event.keyCode === 13 && vm.changeContract(vm.gotoOa)" ng-model="vm.gotoOa">
                        <span class="input-group-btn">
                            <button type="button" class="btn btn-sm btn-warning" ng-click="vm.changeContract(vm.gotoOa)"><i class="fa fa-arrow-right"></i></button>
                        </span>
                    </div>
                    <span ng-show="vm.data.contractRecent.length > 0">
                        <select ng-model="vm.data.currentContractRecent" ng-options="c for c in vm.data.contractRecent" class="form-control input-sm" ng-change="vm.changeContract(vm.data.currentContractRecent)">
                            <option value="">Recent Contracts</option>
                        </select>
                    </span>
                    <button type="button" class="btn btn-sm btn-wide btn-warning" ng-click="vm.newContract()" ng-hide="vm.data.editContract || !vm.data.editAllowed"><i class="fa fa-lg fa-fw fa-file-o"></i> Create New OA</button>
                    <button type="button" class="btn btn-sm btn-wide btn-warning" ng-click="vm.newContract(vm.data.contract)" ng-hide="vm.data.editContract || !vm.data.editAllowed || !vm.data.contract.Contract"><i class="fa fa-lg fa-fw fa-copy"></i> Copy Current OA</button>
                </div>
            </div>
        </form>
        <hr ng-hide="vm.data.editContract" />
        <div ng-show="vm.data.contractReady">
            <div class="well">
                <div class="row">
                    <div class="col-lg-11">
                        <form class="form-horizontal">
                            <div class="row">
                                <div class="col-lg-4">
                                    <div class="row">
                                        <div class="col-lg-12" ng-hide="vm.data.contract.newContract && vm.data.editContract">
                                            <span>
                                                <span class="h3">
                                                    <span tooltip="OA Number">{{vm.data.contract.Contract}}</span>&ensp;
                                                    <span class="small" tooltip="OA Type">{{vm.data.contract.DocType}}</span>
                                                </span>
                                                &ensp;
                                                <span class="h4" tooltip="POrg: {{vm.data.contract.PurchOrg}}">{{vm.data.contract.PurchOrg | csiPsi}}</span>
                                            </span>
                                            <p>
                                                <h3>
                                                    <span class="highlight">{{vm.data.contract.VendorName}}&ensp;</span>
                                                    <span class="small" tooltip="Supplier ID">{{vm.data.contract.Vendor}}</span>
                                                </h3>
                                            </p>
                                            <span class="h4" tooltip="Currency: {{vm.data.contract.Currency.text}}" tooltip-placement="right">{{vm.data.contract.Currency.value}}</span>
                                        </div>
                                        <div class="col-lg-12" ng-show="vm.data.contract.newContract && vm.data.editContract">
                                            <div class="row">
                                                <div class="col-lg-6">
                                                    <div class="form-group">
                                                        <div class="col-sm-4 text-right field-label">OA Type</div>
                                                        <div class="col-sm-8">
                                                            <select ng-model="vm.data.contract.DocType" required ng-change="vm.updateApproveStatus(); vm.populateHeaderDates()" ng-options="t.value as (t.value+' - '+ t.text) for t in vm.data.fixedVal.oaType" data-val="{{vm.data.contract.DocType}}" class="form-control input-sm"></select>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div class="col-lg-6">
                                                    <div class="form-group">
                                                        <div class="col-sm-4 text-right field-label">POrg</div>
                                                        <div class="col-sm-6">
                                                            <select ng-model="vm.data.contract.PurchOrg" required ng-options="t.value as t.text for t in vm.data.fixedVal.purchOrg" data-val="{{vm.data.contract.PurchOrg}}" ng-change="vm.changePorg()" class="form-control input-sm"></select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="form-group">
                                                        <div class="col-sm-2 text-right field-label">Supplier</div>
                                                        <div class="col-sm-4">
                                                            <input type="text" maxlength="10" class="form-control input-sm" required ng-model="vm.data.contract.Vendor" />
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                            <div class="row">
                                                <div class="col-lg-12">
                                                    <div class="form-group">
                                                        <div class="col-sm-2 text-right field-label">Currency</div>
                                                        <div class="col-sm-6">
                                                            <select ng-model="vm.data.contract.Currency" required ng-options="t as (t.value+' - '+t.text) for t in vm.data.fixedVal.currency" data-val="{{vm.data.contract.Currency.value}} - {{vm.data.contract.Currency.text}}" class="form-control input-sm"></select>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="row top-buffer">
                                        <div class="col-lg-12">
                                            <button type="button" class="btn btn-sm btn-wide btn-warning" ng-click="vm.editContract()" ng-hide="vm.data.editContract || !vm.data.editAllowed"><i class="fa fa-lg fa-fw fa-pencil"></i> Edit</button>
                                            <button type="button" class="btn btn-sm btn-wide btn-success" ng-click="vm.saveContract()" ng-show="vm.data.editContract" ng-disabled="vm.processing"><span ng-hide="vm.processing"><i class="fa fa-lg fa-fw fa-save"></i> Save Contract</span><span ng-show="vm.processing">Saving Contract...</span></button>
                                            <button type="button" class="btn btn-sm btn-wide btn-danger" ng-click="vm.discardChanges()" ng-show="vm.data.editContract && !vm.data.contract.newContract" ng-disabled="vm.processing"><i class="fa fa-lg fa-fw fa-times"></i> Discard Changes</button>
                                            <button type="button" class="btn btn-sm btn-wide btn-danger" ng-click="vm.cancelOa()" ng-show="vm.data.editContract && vm.data.contract.newContract" ng-disabled="vm.processing"><i class="fa fa-lg fa-fw fa-times"></i> Cancel OA</button>
                                            <button type="button" class="btn btn-sm btn-wide" ng-class="{'btn-info':!vm.data.contract.errors || vm.validating,'btn-success':!!vm.data.contract.errors && !vm.data.contract.errors.length > 0 && !vm.validating, 'btn-danger':vm.data.contract.errors.length > 0 && !vm.validating}" ng-click="vm.validate()" ng-show="vm.data.editContract" ng-disabled="vm.validating || vm.processing"><span ng-hide="vm.processing"><i class="fa fa-lg fa-fw fa-check-square-o"></i> Validate Contract</span><span ng-show="vm.processing">Validating Contract...</span></button>
                                        </div>
                                    </div>
                                    <div class="row top-buffer">
                                        <div class="col-lg-12">
                                            <button type="button" class="btn btn-sm btn-wide btn-warning" ng-click="vm.newLine()" ng-show="vm.data.editContract" ng-disabled="vm.processing"><i class="fa fa-lg fa-fw fa-plus"></i> Add New Line</button>
                                            <button type="button" class="btn btn-sm btn-wide btn-warning" ng-click="vm.newLine(vm.data.activeContractLine)" ng-show="vm.data.editContract" ng-disabled="vm.processing"><i class="fa fa-lg fa-fw fa-copy"></i> Copy Active Line</button>
                                        </div>
                                    </div>
                                    <div class="row top-buffer" ng-show="vm.data.editContract">
                                        <div class="col-lg-12">
                                            <div drop-target drop="vm.drop(files)" class="alert alert-info drop-target">
                                                <p>Drag an XLSX file here to import.</p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">OA Header Dates</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract"><span tooltip="OA Header Start Date">{{vm.data.contract.VperStart | parseDateString}}</span><span ng-hide="!vm.data.contract.VperStart && !vm.data.contract.VperEnd">&ensp;&ndash;&ensp;</span><span tooltip="OA Header End Date">{{vm.data.contract.VperEnd | parseDateString}}</span></div>
                                            <div ng-show="vm.data.editContract" class="row">
                                                <div class="col-lg-6" tooltip="OA Header Start Date">
                                                    <quick-datepicker disable-timepicker='true' class="form-control input-sm" required ng-model='vm.data.contract.VperStart'></quick-datepicker>
                                                </div>
                                                <div class="col-lg-6" tooltip="OA Header End Date">
                                                    <quick-datepicker disable-timepicker='true' class="form-control input-sm" required ng-model='vm.data.contract.VperEnd'></quick-datepicker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Referenced Contract" tooltip-placement="left">Contract Number</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.contract.ReferencedContract}}</div>
                                            <div ng-show="vm.data.editContract"><input type="text" maxlength="132" class="form-control input-sm" ng-required="vm.data.contract.DocType === 'ZCON' && vm.data.contract.PurchOrg === 'S044'" ng-model="vm.data.contract.ReferencedContract" /></div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Commodity Manager" tooltip-placement="left">CM</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.contract.PurGroup.Description}}<span ng-show="!!vm.data.contract.PurGroup.Description && !!vm.data.contract.PurGroup.PurGroup">&ensp;&bull;&ensp;</span>{{vm.data.contract.PurGroup.PurGroup}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <select ng-model="vm.data.contract.PurGroup" required ng-options="i as (i.Description+' - '+i.PurGroup) for i in vm.data.purGroup | orderBy:'Description'" data-val="{{vm.data.contract.PurGroup.Description}} - {{vm.data.contract.PurGroup.PurGroup}}" class="form-control input-sm"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Capital Capacity Manager" tooltip-placement="left">CCM</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.contract.HdrBuyerField.Description}}<span ng-show="!!vm.data.contract.HdrBuyerField.Description && !!vm.data.contract.HdrBuyerField.PurGroup">&ensp;&bull;&ensp;</span>{{vm.data.contract.HdrBuyerField.PurGroup}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <select ng-model="vm.data.contract.HdrBuyerField" required ng-options="i as (i.Description+' - '+i.PurGroup) for i in vm.data.purGroup | orderBy:'Description'" data-val="{{vm.data.contract.HdrBuyerField.Description}} - {{vm.data.contract.HdrBuyerField.PurGroup}}" class="form-control input-sm"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-4">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Incoterms</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract"><span tooltip="Incoterms Code">{{vm.data.contract.Incoterms1.value}}</span><span ng-show="!!vm.data.contract.Incoterms1 && !!vm.data.contract.Incoterms2">&ensp;&bull;&ensp;</span><span tooltip="Incoterms Location">{{vm.data.contract.Incoterms2}}</span></div>
                                            <div ng-show="vm.data.editContract" class="row">
                                                <div class="col-lg-4" tooltip="Incoterms Code">
                                                    <select ng-model="vm.data.contract.Incoterms1" required ng-options="i as i.value for i in vm.data.fixedVal.incoTerms" data-val="{{vm.data.contract.Incoterms1.value}}" ng-change="vm.populateInco2(vm.data.contract)" class="form-control input-sm">
                                                        <option value=""></option>
                                                    </select>
                                                </div>
                                                <div class="col-lg-8" tooltip="Incoterms Location">
                                                    <input type="text" maxlength="28" class="form-control input-sm" ng-model="vm.data.contract.Incoterms2" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Payment Terms</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.contract.Pmnttrms.value}}<span ng-show="!!vm.data.contract.Pmnttrms.value && !!vm.data.contract.Pmnttrms.text">&ensp;&bull;&ensp;</span>{{vm.data.contract.Pmnttrms.text}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <select ng-model="vm.data.contract.Pmnttrms" required ng-options="i as (i.value+' - '+i.text) for i in vm.data.fixedVal.paymentTerms" data-val="{{vm.data.contract.Pmnttrms.value}} - {{vm.data.contract.Pmnttrms.text}}" class="form-control input-sm"></select>
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Supplier Contact</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.contract.SalesPers}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <input type="text" maxlength="30" class="icon form-control input-sm" ng-model="vm.data.contract.SalesPers" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Supplier Telephone</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.contract.Telephone}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <input type="text" maxlength="16" class="icon form-control input-sm" ng-model="vm.data.contract.Telephone" />
                                            </div>
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">SIRFIS Indicator</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.contract.HdrSirfisFcst}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <select ng-model="vm.data.contract.HdrSirfisFcst" required ng-options="i for i in vm.data.fixedVal.sirfisForecast" data-val="{{vm.data.contract.HdrSirfisFcst}}" class="form-control input-sm"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </form>
                    </div>
                    <div class="col-lg-1 text-right">
                        <div class="small">
                                <button type="button" class="pull-right btn btn-xs btn-primary" ng-click="vm.download()"><i class="fa fa-fw fa-file-excel-o"></i> Download</button>
                            <p>
                                <br />
                                <h5 class="field-label" ng-show="!!vm.data.contract.CreatedBy || !!vm.data.contract.CreatDate">Created</h5>
                                <div id="headerCreateIdsid">{{vm.data.contract.CreatedBy | lowercase}}</div>
                                <div id="headerCreateDate" ng-show="!!vm.data.contract.CreatDate">{{vm.data.contract.CreatDate | parseDateString}}</div>
                            </p>
                            <p>
                                <h5 class="field-label" ng-show="!!vm.data.contract.HdrChangedBy || !!vm.data.contract.HdrChangeDate || !!vm.data.contract.HdrChangeTime">Changed</h5>
                                <div id="headerChangeIdsid">{{vm.data.contract.HdrChangedBy | lowercase}}</div>
                                <div id="headerChangeDate" ng-show="!!vm.data.contract.HdrChangeDate">{{vm.data.contract.HdrChangeDate | parseDateString}}</div>
                                <div id="headerChangeTime" ng-show="!!vm.data.contract.HdrChangeTime">{{vm.data.contract.HdrChangeTime}}</div>
                            </p>
                        </div>
                    </div>
                </div>
                <div class="row top-buffer" ng-show="vm.data.contract.errors.length > 0">
                    <div class="col-lg-12">
                        <alert class="alert alert-danger" type="danger"><span ng-repeat="error in vm.data.contract.errors">{{error}}<br></span></alert>
                    </div>
                </div>

            </div>
            <div class="row">
                <div class="col-lg-6 overflow-x">
                    <table class="table table-striped table-condensed table-hover">
                        <thead>
                            <tr>
                                <th><input type="checkbox" class="checkbox-inline" ng-model="vm.data.contractCheckAll" ng-disabled="!vm.data.editContract" ng-change="vm.changeChecked()" /></th>
                                <th ng-click="vm.sort('ItemNo')"><span class="sortable">Line&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('ItemNo')"></i></a></span></th>
                                <th ng-click="vm.sort('DeleteInd')"><span class="sortable"><i class="fa fa-trash-o"></i>&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('DeleteInd')"></i></a></span></th>
                                <th ng-click="vm.sort('Material.value')"><span class="sortable">MM Number&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('Material.value')"></i></a></span></th>
                                <th ng-click="vm.sort('ShortText')"><span class="sortable">Line Description&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('ShortText')"></i></a></span></th>
                                <th ng-click="vm.sort('PlanDel')"><span class="sortable">LT&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('PlanDel')"></i></a></span></th>
                                <th ng-click="vm.sort('NetPrice')"><span class="sortable">Price&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('NetPrice')"></i></a></span></th>
                                <th ng-click="vm.sort('VendMat')"><span class="sortable">Supplier Part Number&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('VendMat')"></i></a></span></th>
                                <th ng-click="vm.sort('SiteString')"><span class="sortable">Site Extension&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('SiteString')"></i></a></span></th>
                                <th ng-click="vm.sort('SIActive.text')"><span class="sortable">Preferred Status&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('SIActive.text')"></i></a></span></th>
                                <th ng-click="vm.sort('SIStatus.text')"><span class="sortable">Approve Status&nbsp;<a><i class="fa fa-fw" ng-class="vm.getSortClass('SIStatus.text')"></i></a></span></th>
                            </tr>
                            <tr>
                                <td><span tooltip="# of selected lines" tooltip-placement="right">[{{vm.data.contract.Lines | selected}}]</span></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.ItemNo" placeholder="&#xf0b0;" class="icon form-control input-sm"></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.DeleteInd" placeholder="&#xf0b0;" class="icon form-control input-sm" tooltip="Enter !X to show only non-deleted. [! means not]" tooltip-placement="right"></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.Material" placeholder="&#xf0b0;" class="icon form-control input-sm"></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.ShortText" placeholder="&#xf0b0;" class="icon form-control input-sm"></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.PlanDel" placeholder="&#xf0b0;" class="icon form-control input-sm"></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.NetPrice" placeholder="&#xf0b0;" class="icon form-control input-sm"></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.VendMat" placeholder="&#xf0b0;" class="icon form-control input-sm"></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.SiteString" placeholder="&#xf0b0;" class="icon form-control input-sm"></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.SIActive" placeholder="&#xf0b0;" class="icon form-control input-sm"></td>
                                <td><input type="text" ng-model="vm.data.contractFilter.SIStatus" placeholder="&#xf0b0;" class="icon form-control input-sm"></td>
                            </tr>
                        </thead>
                        <tbody>
                            <tr ng-class="{warning: c.Warnings.length > 0, danger: c.errors.length > 0, active: c.Selected, activeLine: c === vm.data.activeContractLine}" ng-click="vm.activateContractLine(c)" ng-dblclick="vm.scroll('lineDetails')" ng-repeat="c in (vm.data.filteredContractLines = (vm.data.contract.Lines | orderBy:[vm.data.contractOrderByField,'Contract','ItemNo']:vm.data.contractReverseSort | filter:vm.data.contractFilter)) track by c.ItemNo">
                                <td><input class="checkbox" type="checkbox" ng-disabled="!vm.data.editContract" ng-model="c.Selected" /></td>
                                <td>{{c.ItemNo}}</td>
                                <td>{{c.DeleteInd}}</span></td>
                                <td>{{c.Material.value}}</td>
                                <td>{{c.ShortText}}</td>
                                <td>{{c.PlanDel}}</td>
                                <td>{{c.NetPrice | number:vm.data.contract.Currency.decimal || 2}}&nbsp;{{vm.data.contract.Currency.value}}</td>
                                <td>{{c.VendMat}}</td>
                                <td>{{c.SiteString}}</td>
                                <td>{{c.SIActive.text || c.SIActive.value}}</td>
                                <td>{{c.SIStatus.text || c.SIStatus.value}}</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
                <div id="lineDetails" class="col-lg-6">
                    <div class="well itemDetails">
                        <form class="form-inline">
                            <div class="row">
                                <div class="col-lg-12">
                                    <button type="button" class="btn btn-sm btn-primary" ng-click="vm.changeLine(false)"><i class="fa fa-fw fa-chevron-left"></i></button>
                                    <input type="text" maxlength="5" class="form-control input-sm" placeholder="Goto Line#" ng-keyup="$event.keyCode === 13 && vm.changeLine(vm.gotoLine)" ng-model="vm.gotoLine">
                                    <button type="button" class="btn btn-sm btn-primary" ng-click="vm.changeLine(true)"><i class="fa fa-fw fa-chevron-right"></i></button>
                                    <button type="button" class="btn btn-sm pull-right" ng-disabled="vm.validating || vm.processing" ng-class="{'btn-info':!vm.data.activeContractLine.errors || vm.validating,'btn-success':!!vm.data.activeContractLine.errors && !vm.data.activeContractLine.errors.length > 0 && !vm.validating, 'btn-danger':vm.data.activeContractLine.errors.length > 0 && !vm.validating}" ng-show="vm.data.editContract" ng-click="vm.validate(vm.data.activeContractLine)"><i class="fa fa-fw fa-check-square-o"></i> Validate Line</button>
                                </div>
                            </div>
                        </form>
                        <form class="form-horizontal">
                            <div class="row top-buffer">
                                <div class="col-lg-3">
                                    <h4>
                                        <input type="checkbox" class="checkbox-inline" ng-disabled="!vm.data.editContract" ng-model="vm.data.activeContractLine.Selected" />&ensp;
                                        <span class="field-label">Line&ensp;</span>
                                        <span>{{vm.data.activeContractLine.ItemNo}}</span>
                                    </h4>
                                </div>
                                <div class="col-lg-6">
                                    <h4>
                                        <div class="form-group">
                                            <div class="col-sm-5 text-right field-label"><span tooltip="Material Master Number" tooltip-placement="left">MM Number</span></div>
                                            <div class="col-sm-7">
                                                <span ng-hide="!!vm.data.activeContractLine.NewLine && vm.data.editContract">{{vm.data.activeContractLine.Material.value}}</span>
                                                <span ng-show="!!vm.data.activeContractLine.NewLine && vm.data.editContract"><input type="text" maxlength="10" class="form-control input-sm" ng-model="vm.data.activeContractLine.Material.value" ng-blur="vm.updateMaterial(vm.data.activeContractLine, true, true)"></span>
                                            </div>
                                        </div>
                                    </h4>
                                </div>
                                <div class="col-lg-3 text-right">
                                    <input type="checkbox" class="checkbox-inline" ng-show="vm.data.editContract" ng-model="vm.data.activeContractLine.DeleteInd" ng-change="vm.deleteLine(vm.data.activeContractLine)" ng-true-value="X" ng-false-value="" />&ensp;
                                    <span class="h4">
                                        <div class="h4 label label-default" ng-class="{'label-danger':vm.data.activeContractLine.DeleteInd ==='X'}" ng-show="vm.data.activeContractLine.DeleteInd === 'X' || vm.data.editContract">
                                            <span ng-show="vm.data.activeContractLine.DeleteInd === 'X'">Deleted</span>
                                            <span ng-hide="vm.data.activeContractLine.DeleteInd === 'X'">Not Deleted</span>
                                        </div>
                                    </span>
                                </div>
                            </div>
                            <div class="row" ng-show="vm.data.activeContractLine.errors.length > 0">
                                <div class="col-lg-12">
                                    <alert class="alert alert-danger" type="danger"><span ng-repeat="error in vm.data.activeContractLine.errors">{{error}}<br></span></alert>
                                </div>
                            </div>
                            <div class="row" ng-class="{'top-buffer': vm.data.activeContractLine.errors.length > 0}" ng-show="vm.data.activeContractLine.Warnings.length > 0">
                                <div class="col-lg-12">
                                    <alert class="alert alert-warning" type="warning"><span ng-repeat="warning in vm.data.activeContractLine.Warnings">{{warning}}<br></span></alert>
                                </div>
                            </div>
                            <div class="row top-buffer">
                                <div class="col-xs-1 col-xs-1-5 text-center">
                                    <div class="small field-label">Preferred Status</div>
                                    <div class="block label label-default"
                                         ng-class="{'label-success':vm.data.activeContractLine.SIActive.value==='X',
                                    'label-danger':vm.data.activeContractLine.SIActive.value==='N'}">
                                        <h6>{{vm.data.activeContractLine.SIActive.text || vm.data.activeContractLine.SIActive.value}}</h6>
                                    </div>
                                    <div ng-show="vm.data.editContract">
                                        <select ng-model="vm.data.activeContractLine.SIActive" required ng-options="s as s.text for s in vm.data.fixedVal.preferredStatus" data-val="{{vm.data.activeContractLine.SIActive.text}}" class="form-control input-sm"></select>
                                    </div>
                                </div>
                                <div class="col-xs-1 col-xs-1-5 text-center">
                                    <div class="small field-label">CM Approval</div>
                                    <div class="block label label-default"
                                         ng-class="{'label-success':vm.data.activeContractLine.SICMApproval.value==='A',
                                    'label-warning':vm.data.activeContractLine.SICMApproval.value==='P'}">
                                        <h6>{{vm.data.activeContractLine.SICMApproval.text || vm.data.activeContractLine.SICMApproval.value}}</h6>
                                    </div>
                                    <div ng-show="vm.data.editContract">
                                        <select ng-model="vm.data.activeContractLine.SICMApproval" ng-options="s as s.text for s in vm.data.fixedVal.cmStatus" data-val="{{vm.data.activeContractLine.SICMApproval.text}}" ng-change="vm.updateApproveStatus(vm.data.activeContractLine)" class="form-control input-sm">
                                            <option value=""></option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-1 col-xs-1-5 text-center">
                                    <div class="small field-label">Site Approval</div>
                                    <div class="block label label-default"
                                         ng-class="{'label-success':vm.data.activeContractLine.SISiteApproval.value==='A' || vm.data.activeContractLine.SISiteApproval.value==='D',
                                    'label-warning':vm.data.activeContractLine.SISiteApproval.value==='P', 'label-danger':vm.data.activeContractLine.SISiteApproval.value==='R'}">
                                        <h6>{{vm.data.activeContractLine.SISiteApproval.text || vm.data.activeContractLine.SISiteApproval.value}}</h6>
                                    </div>
                                    <div ng-show="vm.data.editContract">
                                        <select ng-model="vm.data.activeContractLine.SISiteApproval" ng-options="s as s.text for s in vm.data.fixedVal.siteStatus" data-val="{{vm.data.activeContractLine.SISiteApproval.text}}" ng-change="vm.updateApproveStatus(vm.data.activeContractLine)" class="form-control input-sm">
                                            <option value=""></option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-1 col-xs-1-5 text-center">
                                    <div class="small field-label">TD Approval</div>
                                    <div class="block label label-default"
                                         ng-class="{'label-success':vm.data.activeContractLine.SITDApproval.value==='A' || vm.data.activeContractLine.SITDApproval.value==='D',
                                    'label-warning':vm.data.activeContractLine.SITDApproval.value==='P', 'label-danger':vm.data.activeContractLine.SITDApproval.value==='R'}">
                                        <h6>{{vm.data.activeContractLine.SITDApproval.text || vm.data.activeContractLine.SITDApproval.value}}</h6>
                                    </div>
                                    <div ng-show="vm.data.editContract">
                                        <select ng-model="vm.data.activeContractLine.SITDApproval" ng-options="s as s.text for s in vm.data.fixedVal.tdStatus" data-val="{{vm.data.activeContractLine.SITDApproval.text}}" ng-change="vm.updateApproveStatus(vm.data.activeContractLine)" class="form-control input-sm">
                                            <option value=""></option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-xs-1 col-xs-1-5 text-center">
                                    <div class="small field-label">Approve Status</div>
                                    <div class="block label label-default"
                                         ng-class="{'label-success':vm.data.activeContractLine.SIStatus.value==='A', 'label-danger':vm.data.activeContractLine.SIStatus.value==='N'}">
                                        <h6>{{vm.data.activeContractLine.SIStatus.text || vm.data.activeContractLine.SIStatus.value}}</h6>
                                    </div>
                                </div>
                            </div>
                            <hr />
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Line Dates</div>
                                        <div class="col-sm-6">
                                            <div ng-hide="vm.data.editContract"><span tooltip="Line Start Date">{{vm.data.activeContractLine.ConditionStart | parseDateString}}</span>&ensp;&ndash;&ensp;<span tooltip="Line End Date">{{vm.data.activeContractLine.ConditionEnd | parseDateString}}</span></div>
                                            <div ng-show="vm.data.editContract" class="row">
                                                <div class="col-lg-6" tooltip="Line Start Date">
                                                    <quick-datepicker disable-timepicker='true' class="form-control input-sm" required ng-model='vm.data.activeContractLine.ConditionStart'></quick-datepicker>
                                                </div>
                                                <div class="col-lg-6" tooltip="Line End Date">
                                                    <quick-datepicker disable-timepicker='true' class="form-control input-sm" required ng-model='vm.data.activeContractLine.ConditionEnd'></quick-datepicker>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Line Description</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.ShortText}}</div>
                                            <div ng-show="vm.data.editContract"><input type="text" maxlength="40" class="form-control input-sm" required ng-blur="vm.populateDescription(vm.data.activeContractLine)" ng-model="vm.data.activeContractLine.ShortText" /></div>
                                            <div class="small text-muted" ng-show="!!vm.data.activeContractLine.Material.value && vm.data.activeContractLine.ShortText.toString().toLowerCase() !== vm.data.activeContractLine.Material.MMDesc.toString().toLowerCase()"><em>MM Desc:</em> {{vm.data.activeContractLine.Material.MMDesc}}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span>Linked Quote</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.QuoteDIR}}</div>
                                            <div ng-show="vm.data.editContract"><input type="text" maxlength="132" class="form-control input-sm" ng-change="vm.getDocument(vm.data.activeContractLine, true)" ng-blur="vm.getDocument(vm.data.activeContractLine, true, true)" ng-model="vm.data.activeContractLine.QuoteDIR" /></div>
                                            <div class="small text-muted" ng-show="!!vm.data.activeContractLine.ReferencedQuote"><em>Quote Name:</em> {{vm.data.activeContractLine.ReferencedQuote}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">MM Subcategory</div>
                                        <div class="col-sm-8">
                                            <div class="text-muted">{{vm.data.activeContractLine.Material.SupItemSubcategoryNm}}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">MM SL</div>
                                        <div class="col-sm-8">
                                            <div class="text-muted">{{vm.data.activeContractLine.Material.SlInd}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Supplier Part Number</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.VendMat}}</div>
                                            <div ng-show="vm.data.editContract"><input type="text" maxlength="35" class="form-control input-sm" required ng-blur="vm.populateManufPart(vm.data.activeContractLine)" ng-model="vm.data.activeContractLine.VendMat" /></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Unforecasted Lead Time" tooltip-placement="left">Unfcst LT</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.PlanDel}} day<span ng-hide="vm.data.activeContractLine.PlanDel === 1 || vm.data.activeContractLine.PlanDel === '1'">s</span></div>
                                            <div ng-show="vm.data.editContract">
                                                <p class="input-group">
                                                    <input type="text" maxlength="3" class="form-control input-sm" required ng-model="vm.data.activeContractLine.PlanDel" ng-blur="vm.populateForecastLt(vm.data.activeContractLine)" />
                                                    <span class="input-group-addon">days</span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Price</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">
                                                {{vm.data.activeContractLine.NetPrice | number:vm.data.contract.Currency.decimal || 2}} {{vm.data.contract.Currency.value}}
                                                <span ng-hide="vm.data.contract.Currency.value === 'USD'">&ensp;[{{vm.data.activeContractLine.NetPrice * vm.data.contract.ExchRate | number:2}} USD]</span>
                                                <span ng-show="vm.data.activeContractLine.ScaleBaseType === 'X'" tooltip="Tier Discount Indicator" tooltip-placement="right"> <i class="fa fa-flip-horizontal fa-fw fa-signal"></i></span>
                                            </div>
                                            <div ng-show="vm.data.editContract">
                                                <p class="input-group">
                                                    <input type="text" maxlength="11" class="form-control input-sm" required ng-model="vm.data.activeContractLine.NetPrice" ng-keyup="vm.cleanPrice(vm.data.activeContractLine)" ng-paste="vm.cleanPrice(vm.data.activeContractLine)" ng-blur="vm.cleanPrice(vm.data.activeContractLine)" />
                                                    <span class="input-group-addon">{{vm.data.contract.Currency.value}}<span ng-show="vm.data.activeContractLine.ScaleBaseType === 'X'" tooltip="Tier Discount Indicator" tooltip-placement="right"> <i class="fa fa-flip-horizontal fa-fw fa-signal"></i></span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Unit of Measure" tooltip-placement="left">UOM</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="!!vm.data.activeContractLine.NewLine && vm.data.editContract">
                                                {{vm.data.activeContractLine.OrderprUn.uom.text}}&ensp;
                                                <span class="small text-muted" ng-show="!!vm.data.activeContractLine.Material.MMBaseUom && vm.data.activeContractLine.OrderprUn.uom.value !== vm.data.activeContractLine.Material.MMBaseUom">
                                                    <em>{{vm.data.activeContractLine.OrderprUn.altAmt}} {{vm.data.activeContractLine.OrderprUn.uom.value}} = {{vm.data.activeContractLine.OrderprUn.baseAmt}} {{vm.data.activeContractLine.Material.MMBaseUom}}</em>
                                                </span>
                                            </div>
                                            <div ng-show="!!vm.data.activeContractLine.NewLine && vm.data.editContract">
                                                <select ng-model="vm.data.activeContractLine.OrderprUn" required ng-options="i as (i.uom.value + ' - ' + i.uom.text + '&emsp;' + vm.getAltUomText(i,vm.data.activeContractLine.Material)) for i in vm.updateUoms(vm.data.activeContractLine)" data-val="{{vm.data.activeContractLine.OrderprUn.uom.value}} - {{vm.data.activeContractLine.OrderprUn.uom.text}}" class="form-control input-sm"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Incoterms</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract"><span tooltip="Incoterms Code">{{vm.data.activeContractLine.Incoterms1.value}}</span><span ng-show="!!vm.data.activeContractLine.Incoterms1 && !!vm.data.activeContractLine.Incoterms2">&ensp;&bull;&ensp;</span><span tooltip="Incoterms Location">{{vm.data.activeContractLine.Incoterms2}}</span></div>
                                            <div ng-show="vm.data.editContract" class="row">
                                                <div class="col-lg-5">
                                                    <select ng-model="vm.data.activeContractLine.Incoterms1" ng-options="i as i.value for i in vm.data.fixedVal.incoTerms" data-val="{{vm.data.activeContractLine.Incoterms1.value}}" ng-change="vm.populateInco2(vm.data.activeContractLine)" class="form-control input-sm" tooltip="Incoterms Code">
                                                        <option value=""></option>
                                                    </select>
                                                </div>
                                                <div class="col-lg-7">
                                                    <input type="text" maxlength="28" class="form-control input-sm" ng-model="vm.data.activeContractLine.Incoterms2" tooltip="Incoterms Location" />
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Shipping Instructions" tooltip-placement="left">Shipping Instr</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.Shipping.value}}<span ng-show="!!vm.data.activeContractLine.Shipping.value && !!vm.data.activeContractLine.Shipping.text">&ensp;&bull;&ensp;</span>{{vm.data.activeContractLine.Shipping.text}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <select ng-model="vm.data.activeContractLine.Shipping" ng-options="i as (i.value+' - '+i.text) for i in vm.data.fixedVal.shipInst" data-val="{{vm.data.activeContractLine.Shipping.value}} - {{vm.data.activeContractLine.Shipping.text}}" class="form-control input-sm">
                                                    <option value=""></option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Manufacturer Name" tooltip-placement="left">Manuf. Name</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SIMfrnr}}</div>
                                            <div ng-show="vm.data.editContract"><input type="text" maxlength="35" class="form-control input-sm" required ng-blur="vm.populateManufName(vm.data.activeContractLine)" ng-model="vm.data.activeContractLine.SIMfrnr" /></div>
                                            <div class="small text-muted" ng-show="!!vm.data.activeContractLine.Material.value && vm.data.activeContractLine.SIMfrnr.toString().toLowerCase() !== vm.data.activeContractLine.Material.SlSupplierName.toString().toLowerCase()"><em>MM SL Supplier: </em>{{vm.data.activeContractLine.Material.SlSupplierName}}</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Manufacturer Part Number" tooltip-placement="left">Manuf. Part</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SIMfrpn}}</div>
                                            <div ng-show="vm.data.editContract"><input type="text" maxlength="40" class="form-control input-sm" required ng-blur="vm.populateManufPart(vm.data.activeContractLine)" ng-model="vm.data.activeContractLine.SIMfrpn" /></div>
                                            <div class="small text-muted" ng-show="!!vm.data.activeContractLine.Material.value && vm.data.activeContractLine.SIMfrpn.toString().toLowerCase() !== vm.data.activeContractLine.Material.SlSupplierPartNum.toString().toLowerCase()"><em>MM SL Supplier Part#: </em>{{vm.data.activeContractLine.Material.SlSupplierPartNum}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Supplier Difference Justification" tooltip-placement="left">Supplier Diff. Justification</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SISupplierDiffJustif}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <select ng-model="vm.data.activeContractLine.SISupplierDiffJustif" ng-options="i as (index + ' - ' + i) for (index,i) in vm.data.fixedVal.supplierDifference" data-val="{{vm.data.activeContractLine.SISupplierDiffJustif}}" ng-required="vm.requiredSuppJustification(vm.data.activeContractLine)" class="form-control input-sm"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Model Difference Justification" tooltip-placement="left">Model Diff. Justification</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SIModelDiffJustif}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <select ng-model="vm.data.activeContractLine.SIModelDiffJustif" ng-options="i as (index + ' - ' + i) for (index,i) in vm.data.fixedVal.modelDifference" data-val="{{vm.data.activeContractLine.SIModelDiffJustif}}" ng-required="vm.requiredModelJustification(vm.data.activeContractLine)" class="form-control input-sm"></select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Supplier Difference Justification Comment" tooltip-placement="left">Supplier Diff. Justification Comments</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SISupplierDiffComment}}</div>
                                            <div ng-show="vm.data.editContract"><textarea rows="3" maxlength="255" class="form-control input-sm" ng-required="vm.commentsRequired(vm.data.activeContractLine.SISupplierDiffJustif,vm.data.fixedVal.supplierDifference)" ng-model="vm.data.activeContractLine.SISupplierDiffComment" /></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Model Difference Justification Comment" tooltip-placement="left">Model Diff. Justification Comments</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SIModelDiffComment}}</div>
                                            <div ng-show="vm.data.editContract"><textarea rows="3" maxlength="255" class="form-control input-sm" ng-required="vm.commentsRequired(vm.data.activeContractLine.SIModelDiffJustif,vm.data.fixedVal.modelDifference)" ng-model="vm.data.activeContractLine.SIModelDiffComment" /></div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Forecasted Lead Time in Calendar Days" tooltip-placement="left">Fcst LT</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SIFcstLt}}<span ng-show="!!vm.data.activeContractLine.SIFcstLt"> day<span ng-hide="vm.data.activeContractLine.SIFcstLt.toString().trim() === '1'">s</span></span></div>
                                            <div ng-show="vm.data.editContract">
                                                <p class="input-group">
                                                    <input type="text" maxlength="5" class="form-control input-sm" ng-model="vm.data.activeContractLine.SIFcstLt" />
                                                    <span class="input-group-addon">days</span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Forecast Notice" tooltip-placement="left">Fcst Notice</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SIFcstNotice}}<span ng-show="!!vm.data.activeContractLine.SIFcstNotice"> day<span ng-hide="vm.data.activeContractLine.SIFcstNotice.toString().trim() === '1'">s</span></span></div>
                                            <div ng-show="vm.data.editContract">
                                                <p class="input-group">
                                                    <input type="text" maxlength="5" class="form-control input-sm" ng-required="vm.data.contract.PurchOrg === 'S044' && vm.data.activeContractLine.PlanDel.toString().trim() !== vm.data.activeContractLine.SIFcstLt.toString().trim()" ng-model="vm.data.activeContractLine.SIFcstNotice" />
                                                    <span class="input-group-addon">days</span>
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label"><span tooltip="Number of Days Before Expiration" tooltip-placement="left">Expiration Notice</span></div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SIITMRequotingTime}}<span ng-show="!!vm.data.activeContractLine.SIITMRequotingTime"> day<span ng-hide="vm.data.activeContractLine.SIITMRequotingTime.toString().trim() === '1'">s</span></div>
                                            <div ng-show="vm.data.editContract">
                                                <p class="input-group">
                                                    <input type="text" maxlength="3" class="form-control input-sm" ng-required="vm.data.contract.PurchOrg === 'S044'" ng-model="vm.data.activeContractLine.SIITMRequotingTime" />
                                                    <span class="input-group-addon">days</span>
                                                </p>

                                            </div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">CE Marking</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SICeMarking.text}}</div>
                                            <div ng-show="vm.data.editContract">
                                                <select ng-model="vm.data.activeContractLine.SICeMarking" ng-options="i as i.text for i in vm.data.fixedVal.ceMarking" data-val="{{vm.data.activeContractLine.SICeMarking.text}}" class=" form-control input-sm">
                                                    <option value=""></option>
                                                </select>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">Min Order Qty</div>
                                        <div class="col-sm-8">
                                            <div ng-hide="vm.data.editContract">{{vm.data.activeContractLine.SIMinOrderQty}}</div>
                                            <div ng-show="vm.data.editContract"><input type="text" maxlength="13" class="form-control input-sm" ng-model="vm.data.activeContractLine.SIMinOrderQty" /></div>
                                        </div>
                                    </div>
                                </div>
                                <div class="col-lg-6">
                                    <div class="form-group">
                                        <div class="col-sm-4 text-right field-label">MM Electrical Usage</div>
                                        <div class="col-sm-8">
                                            <div class="text-muted">{{vm.data.activeContractLine.Material.ElectricityUsageInd}}</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="small text-center">
                                        <span class="h5 field-label">Created:&ensp;</span>
                                        <span id="lineCreateIdsid">{{vm.data.activeContractLine.SICreatedBy | lowercase}}</span>&ensp;
                                        <span id="lineCreateDate">{{vm.data.activeContractLine.SICreateDate | parseDateString}}</span>
                                        <span class="h5 field-label">&emsp;<!--&mdash;-->&emsp;Changed:&ensp;</span>
                                        <span id="lineChangeIdsid">{{vm.data.activeContractLine.SIChangedBy | lowercase}}</span>&ensp;
                                        <span id="lineChangeDate">{{vm.data.activeContractLine.SIChangeDate | parseDateString}}</span>&ensp;
                                        <span id="lineChangeTime">{{vm.data.activeContractLine.SIChangeTime}}</span>
                                    </div>
                                </div>
                            </div>
                            <hr />
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="field-label text-center">
                                        Site and Shipping Conditions
                                    </div>
                                    <div class="row" ng-show="vm.data.editContract && vm.data.activeContractLine.AllSites.length > 0">
                                        <div class="col-lg-12">
                                            <button type="button" class="btn btn-xs btn-success" ng-click="vm.selectSites('all')"><i class="fa fa-fw fa-check-square-o"></i> Select All</button>
                                            <button type="button" class="btn btn-xs btn-danger" ng-click="vm.selectSites('none')"><i class="fa fa-fw fa-square-o"></i> Deselect All</button>
                                            <button type="button" class="btn btn-xs btn-primary" ng-click="vm.selectSites('us')"><i class="fa fa-fw fa-flag"></i> Select U.S.</button>
                                        </div>
                                    </div>
                                    <div class="row">
                                        <div class="col-lg-6">
                                            <div class="row">
                                                <div class="col-lg-10 col-lg-offset-1">
                                                    <div class="row" ng-repeat="s in vm.data.activeContractLine.AllSites | orderBy:'site'" ng-show="vm.firstHalf($index,vm.data.activeContractLine.AllSites.length)">
                                                        <div class="col-xs-4">
                                                            <span class="checkbox">
                                                                <input type="checkbox" data-val="{{s.site}}" ng-disabled="!vm.data.editContract" ng-model="s.Selected" ng-change="vm.updateSiteString()" />{{s.site}}
                                                            </span>
                                                        </div>
                                                        <div class="col-xs-8 checkbox">
                                                            <div ng-hide="vm.data.editContract || !s.Selected">{{s.ShippingCondition.value}}<span ng-show="!!s.ShippingCondition.value && !!s.ShippingCondition.text">&ensp;&bull;&ensp;</span>{{s.ShippingCondition.text}}</div>
                                                            <div ng-show="vm.data.editContract">
                                                                <select ng-model="s.ShippingCondition" data-site="{{s.site}}" data-val="{{s.ShippingCondition.value}} - {{s.ShippingCondition.text}}" ng-disabled="!s.Selected" ng-options="i as (i.value+' - '+i.text) for i in vm.data.fixedVal.shipCond" class="form-control input-sm"></select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="col-lg-6">
                                            <div class="row">
                                                <div class="col-lg-10 col-lg-offset-1">
                                                    <div class="row" ng-repeat="s in vm.data.activeContractLine.AllSites | orderBy:'site'" ng-hide="vm.firstHalf($index,vm.data.activeContractLine.AllSites.length)">
                                                        <div class="col-xs-4">
                                                            <span class="checkbox">
                                                                <input type="checkbox" data-val="{{s.site}}" ng-disabled="!vm.data.editContract" ng-model="s.Selected" ng-change="vm.updateSiteString()" />{{s.site}}
                                                            </span>
                                                        </div>
                                                        <div class="col-xs-8 checkbox">
                                                            <div ng-hide="vm.data.editContract || !s.Selected">{{s.ShippingCondition.value}}<span ng-show="!!s.ShippingCondition.value && !!s.ShippingCondition.text">&ensp;&bull;&ensp;</span>{{s.ShippingCondition.text}}</div>
                                                            <div ng-show="vm.data.editContract">
                                                                <select ng-model="s.ShippingCondition" data-site="{{s.site}}" data-val="{{s.ShippingCondition.value}} - {{s.ShippingCondition.text}}" ng-disabled="!s.Selected" ng-options="i as (i.value+' - '+i.text) for i in vm.data.fixedVal.shipCond" class="form-control input-sm"></select>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    <hr ng-show="vm.data.activeContractLine.BadSites.length > 0" />
                                    <div class="row" ng-show="vm.data.activeContractLine.BadSites.length > 0">
                                        <div class="col-lg-12"><em>These sites are currently selected but not valid for the POrg. Please deselect them and save.</em></div>
                                        <div class="col-lg-10 col-lg-offset-1">
                                            <div class="row">
                                                <div class="col-lg-2" ng-repeat="s in vm.data.activeContractLine.BadSites | orderBy:'site'">
                                                    <span class="checkbox">
                                                        <input type="checkbox" ng-disabled="!vm.data.editContract" ng-model="s.Selected" ng-change="vm.updateSiteString()" />{{s.site}}
                                                    </span>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            <hr />
                            <div class="row">
                                <div class="col-lg-12">
                                    <div class="field-label">
                                        Comments
                                    </div>
                                </div>
                                <div class="col-lg-12">
                                    <textarea rows="8" maxlength="16000" class="form-control input-sm" ng-disabled="!vm.data.editContract" ng-model="vm.data.activeContractLine.NoteLongText" />
                                </div>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>