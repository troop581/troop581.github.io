"use strict";var app=angular.module("app",["ngRoute","ngSanitize","ui.bootstrap"]);app.config(["$tooltipProvider","$routeProvider","$httpProvider",function(t,e,a){t.options({popupDelay:500}),a.defaults.withCredentials=!0,e.when("/flags",{title:"Flags",templateUrl:"app/modules/flags.html",resolve:{dataService:function(t){return t.init()}}}).when("/flyer",{title:"Flyer",templateUrl:"app/modules/flyer.html",resolve:{dataService:function(t){return t.init()}}}).when("/success",{title:"Thank you",templateUrl:"app/modules/success.html",resolve:{dataService:function(t){return t.init()}}}).otherwise({redirectTo:"/flags"})}]),app.run(["$route","$rootScope",function(t,n){n.$on("$routeChangeSuccess",function(t,e,a){n.title="Troop 581 - "+e.$$route.title})}]),toastr.options={closeButton:!1,debug:!1,positionClass:"toast-bottom-left",onclick:null,showDuration:"4000",hideDuration:"1000",timeOut:"4000",extendedTimeOut:"1000",showEasing:"linear",hideEasing:"linear",showMethod:"show",hideMethod:"hide"},app.controller("header",["$location","dataService",function(t,e){var a=this;return a.data=e,a.location=t,a}]),app.controller("shell",["$location","$modal","dataService",function(e,t,a){var n=this;return n.data=a,n.isActive=function(t){return t===e.path().substr(0,t.length)},n.openSettings=function(){t.open({templateUrl:"app/modules/settings.html",controller:"settings as vm"}).result.then(function(){},function(){})},n}]),app.controller("flags.boundaries",["dataService","$modalInstance","$q",function(t,e,a){var n=this;return n.data=t,n.close=function(){e.close()},n}]),app.controller("flags",["dataService","$q","$modal","$timeout","$filter",function(e,t,a,n,o){var r=this;return r.data=e,r.autosave=function(){localStorage.setItem("flags.values",JSON.stringify(e.values))},r.donate=function(t){return toastr.clear(),e.values.subscribe||e.values.donate?e.values.donate&&!e.values.donation?(toastr.warning("","You selected to give a donation but did not enter an amount."),void t.preventDefault()):e.values.donation&&(!_.toNumber(e.values.donation)||parseInt(e.values.donation,10)<0)?(toastr.warning("","Please check your donation amount. It doesn't appear to be correct."),void t.preventDefault()):e.values.subscribe&&r.getTotal()<e.cost?(toastr.error("","An error occurred. Please fix the data and try again.",{timeOut:0}),void t.preventDefault()):r.getTotal()<5?(toastr.warning("","$5.00 is the minimum amount we can process through PayPal."),void t.preventDefault()):!e.values.name||!e.values.address&&e.values.subscribe?(toastr.warning("","Please fill in all required fields."),void t.preventDefault()):(toastr.info("","You will now be sent to PayPal to finish the transaction.",{timeOut:0}),void n(function(){},5e3)):(toastr.warning("","You have not selected the flag service or a donation."),void t.preventDefault())},r.getDescription=function(){var t="";return e.values.subscribe?(t+=e.year+" Flag Subscription",e.values.donate&&e.values.donation&&(t+=" and Donation of "+o("currency")(e.values.donation,"$",2))):e.values.donate&&e.values.donation&&(t+="Donation of "+o("currency")(e.values.donation,"$",2)),t},r.getDonation=function(){return!_.toNumber(e.values.donation)||parseInt(e.values.donation,10)<0?0:parseInt(e.values.donation,10)},r.getTotal=function(){var t=0;return e.values.subscribe&&(t+=e.cost),e.values.donate&&(t+=r.getDonation()),t},r.showBoundaries=function(){toastr.clear(),a.open({templateUrl:"app/modules/flags.boundaries.html",controller:"flags.boundaries as vm",size:"lg"}).result.then(function(){},function(){})},e.values=JSON.parse(localStorage.getItem("flags.values"))||{},e.disabled&&(e.values={}),r}]),app.controller("flyer",["dataService","$q","$modal","$timeout","$filter",function(t,e,a,n,o){return this.data=t,this}]),app.controller("success",["dataService","$q","$modal","$timeout","$filter",function(t,e,a,n,o){return this.data=t,this}]),app.factory("dataService",["$http","$filter","$q",function(e,t,a){var n={disabled:!0,year:2019,cost:45,values:{}};function o(t,e,a,n){var o=moment().year(n).month(a).date(1).hours(0).minutes(0).seconds(0).milliseconds(0);if(-1===t)for(o.endOf("month").startOf("day");o.day()!==e;)o.subtract(1,"day");else for(o.date(7*(t-1)+1);o.day()!==e;)o.add(1,"day");return o}return n.holidays=[{text:"Memorial Day",date:o(-1,1,4,n.year),dateNoYear:"Last Monday in May"},{text:"Flag Day",date:moment(n.year+"-06-14"),dateNoYear:"June 14th"},{text:"Independence Day",date:moment(n.year+"-07-04"),dateNoYear:"July 4th"},{text:"Patriot Day",date:moment(n.year+"-09-11"),dateNoYear:"September 11th"},{text:"Columbus Day",date:o(2,1,9,n.year),dateNoYear:"Second Monday in October"},{text:"Veterans Day",date:moment(n.year+"-11-11"),dateNoYear:"November 11th"},{text:"Martin Luther King, Jr. Day",date:o(3,1,0,n.year+1),dateNoYear:"Third Monday in January"},{text:"Presidents' Day",date:o(3,1,1,n.year+1),dateNoYear:"Third Monday in February"}],n.processDonation=function(t){return e.get(t).then(function(t){return t})},n.init=function(){},n}]),app.filter("momentToString",["$filter","$locale",function(t,e){return function(t,e){return moment.isMoment(t)?t.format(e):""}}]);